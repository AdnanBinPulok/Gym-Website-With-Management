<!-- include tailwind -->
<script src="https://cdn.tailwindcss.com"></script>
<style>
    .menu-item.active {
        background-color: rgba(51, 65, 85, 0.7) !important;
        color: white !important;
    }
</style>

<!-- Mobile menu button -->
<div class="lg:hidden fixed top-4 right-4 z-50">    
    <button id="mobile-menu-toggle" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-3 rounded-xl shadow-lg hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-blue-400 transform hover:scale-105 transition-all duration-200">
        <i class="fas fa-bars w-5 h-5"></i>
    </button>
</div>

<!-- Overlay for mobile -->
<div id="sidebar-overlay" class="lg:hidden fixed inset-0 bg-black bg-opacity-60  z-40 hidden transition-all duration-300"></div>

<!-- Dashboard sidebar responsive -->
<div id="sidebar" class="w-64 h-screen bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 text-white fixed top-0 left-0 z-50 transform -translate-x-full lg:translate-x-0 transition-all duration-300 ease-in-out shadow-2xl border-r border-slate-700/50">    <div class="p-4 h-full flex flex-col">        <!-- Close button for mobile -->
        <div class="lg:hidden flex justify-between items-center mb-4">
            <div class="flex items-center space-x-2">                
                <div class="w-12 h-12 rounded-lg flex items-center justify-center">
                    {% if data.site.logo %}
                        <img src="{{ data.site.logo or '' }}" alt="Site Icon" class="rounded-lg">
                    {% else %}
                        <i class="fas fa-bolt text-white text-xs"></i>
                    {% endif %}
                </div>
                <h1 class="text-lg font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">{{ data.site.name or 'Unknown' }}</h1>
            </div>            
            <button id="close-sidebar" class="text-slate-400 hover:text-white focus:outline-none hover:bg-slate-700 p-1.5 rounded-lg transition-all duration-200">
                <i class="fas fa-times w-4 h-4"></i>
            </button>
        </div>
          <!-- Desktop header -->
        <div class="hidden lg:block mb-6">
            <div class="flex items-center space-x-2 mb-2">                
                <div class="w-8 h-8 rounded-lg flex items-center justify-center shadow-lg">
                    {% if data.site.logo %}
                        <img src="{{ data.site.logo or '' }}" alt="Site Icon" class="rounded-lg">
                    {% else %}
                        <i class="fas fa-bolt text-white text-xs"></i>
                    {% endif %}
                </div>
                <div>
                    <h1 class="text-xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">{{ data.site.name or 'Unknown' }}</h1>
                    <p class="text-slate-400 text-xs">Welcome back!</p>
                </div>
            </div>
            <div class="h-px bg-gradient-to-r from-blue-500/20 to-purple-600/20"></div> 
        </div>        
        <nav class="menu-list space-y-1 flex-1 overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-transparent">
            <div class="mb-4">
                <h2 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 px-3">Navigation</h2>                
                <ul class="space-y-1">
                    <li>
                        <a id="dashboard" href="/dashboard" class="menu-item group flex items-center px-3 py-2 rounded-lg text-slate-300 hover:text-white hover:bg-slate-700/50 transition-all duration-200 relative overflow-hidden {% if active_page == 'dashboard' %}active{% endif %}">
                            <div class="absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-600/10 opacity-0 group-hover:opacity-100 transition-opacity duration-200"></div>
                            <div class="relative flex items-center">                                
                                <div class="w-6 h-6 rounded-md bg-slate-700 group-hover:bg-blue-500/20 flex items-center justify-center mr-2 transition-all duration-200">
                                    <i class="fas fa-home text-xs text-slate-400 group-hover:text-blue-400"></i>
                                </div>
                                <span class="font-medium text-sm">Dashboard</span>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a id="users" href="/dashboard/users" class="menu-item group flex items-center px-3 py-2 rounded-lg text-slate-300 hover:text-white hover:bg-slate-700/50 transition-all duration-200 relative overflow-hidden {% if active_page == 'users' %}active{% endif %}">
                            <div class="absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-600/10 opacity-0 group-hover:opacity-100 transition-opacity duration-200"></div>
                            <div class="relative flex items-center">
                                <div class="w-6 h-6 rounded-md bg-slate-700 group-hover:bg-green-500/20 flex items-center justify-center mr-2 transition-all duration-200">
                                    <i class="fas fa-users text-xs text-slate-400 group-hover:text-green-400"></i>
                                </div>
                                <span class="font-medium text-sm">Users</span>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a id="payments" href="/dashboard/payments" class="menu-item group flex items-center px-3 py-2 rounded-lg text-slate-300 hover:text-white hover:bg-slate-700/50 transition-all duration-200 relative overflow-hidden {% if active_page == 'payments' %}active{% endif %}">
                            <div class="absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-600/10 opacity-0 group-hover:opacity-100 transition-opacity duration-200"></div>
                            <div class="relative flex items-center">
                                <div class="w-6 h-6 rounded-md bg-slate-700 group-hover:bg-emerald-500/20 flex items-center justify-center mr-2 transition-all duration-200">
                                    <i class="fas fa-credit-card text-xs text-slate-400 group-hover:text-emerald-400"></i>
                                </div>
                                <span class="font-medium text-sm">Payments</span>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a id="gallery" href="/dashboard/gallery" class="menu-item group flex items-center px-3 py-2 rounded-lg text-slate-300 hover:text-white hover:bg-slate-700/50 transition-all duration-200 relative overflow-hidden {% if active_page == 'gallery' %}active{% endif %}">
                            <div class="absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-600/10 opacity-0 group-hover:opacity-100 transition-opacity duration-200"></div>
                            <div class="relative flex items-center">
                                <div class="w-6 h-6 rounded-md bg-slate-700 group-hover:bg-purple-500/20 flex items-center justify-center mr-2 transition-all duration-200">
                                    <i class="fas fa-images text-xs text-slate-400 group-hover:text-purple-400"></i>
                                </div>
                                <span class="font-medium text-sm">Gallery</span>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a id="schedule" href="/dashboard/schedule" class="menu-item group flex items-center px-3 py-2 rounded-lg text-slate-300 hover:text-white hover:bg-slate-700/50 transition-all duration-200 relative overflow-hidden {% if active_page == 'schedule' %}active{% endif %}">
                            <div class="absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-600/10 opacity-0 group-hover:opacity-100 transition-opacity duration-200"></div>
                            <div class="relative flex items-center">
                                <div class="w-6 h-6 rounded-md bg-slate-700 group-hover:bg-orange-500/20 flex items-center justify-center mr-2 transition-all duration-200">
                                    <i class="fas fa-calendar text-xs text-slate-400 group-hover:text-orange-400"></i>
                                </div>
                                <span class="font-medium text-sm">Schedule</span>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a id="settings" href="/dashboard/settings" class="menu-item group flex items-center px-3 py-2 rounded-lg text-slate-300 hover:text-white hover:bg-slate-700/50 transition-all duration-200 relative overflow-hidden {% if active_page == 'settings' %}active{% endif %}">
                            <div class="absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-600/10 opacity-0 group-hover:opacity-100 transition-opacity duration-200"></div>
                            <div class="relative flex items-center">
                                <div class="w-6 h-6 rounded-md bg-slate-700 group-hover:bg-amber-500/20 flex items-center justify-center mr-2 transition-all duration-200">
                                    <i class="fas fa-cog text-xs text-slate-400 group-hover:text-amber-400"></i>
                                </div>
                                <span class="font-medium text-sm">Settings</span>
                            </div>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>        <!-- Bottom section -->
        <div class="mt-2">
            <div class="bg-slate-800/50 rounded-lg p-3 border border-slate-700/50">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center">
                        {% if data.user.avatar_url %}
                            <img src="{{ data.user.avatar_url }}" alt="{{ data.user.username }}" class="w-8 h-8 rounded-full">
                        {% else %}
                            <span class="text-xs font-semibold text-white">{{ data.user.full_name[0] }}</span>
                        {% endif %}
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-xs font-medium text-white truncate">{{ data.user.full_name }}</p>
                        <p class="text-xs text-slate-400">@{{ data.user.username }}</p>
                        <p class="text-xs text-white w-fit bg-gray-600 rounded px-1.5 py-0.5 mt-1">{{ data.user.role }}</p>
                    </div>
                    <a href="/logout" class="text-slate-400 hover:text-white transition-colors duration-200">
                        <i class="fas fa-sign-out-alt text-xs"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Mobile menu functionality
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const sidebar = document.getElementById('sidebar');
    const sidebarOverlay = document.getElementById('sidebar-overlay');
    const closeSidebar = document.getElementById('close-sidebar');

    function openSidebar() {
        sidebar.classList.remove('-translate-x-full');
        sidebarOverlay.classList.remove('hidden');
        document.body.classList.add('overflow-hidden');
    }

    function closeSidebarFunction() {
        sidebar.classList.add('-translate-x-full');
        sidebarOverlay.classList.add('hidden');
        document.body.classList.remove('overflow-hidden');
    }

    mobileMenuToggle.addEventListener('click', openSidebar);
    closeSidebar.addEventListener('click', closeSidebarFunction);
    sidebarOverlay.addEventListener('click', closeSidebarFunction);

    // Close sidebar on link click for mobile
    const sidebarLinks = sidebar.querySelectorAll('a');
    sidebarLinks.forEach(link => {
        link.addEventListener('click', () => {
            if (window.innerWidth < 1024) {
                closeSidebarFunction();
            }
        });
    });

    // Handle window resize
    window.addEventListener('resize', () => {
        if (window.innerWidth >= 1024) {
            sidebar.classList.remove('-translate-x-full');
            sidebarOverlay.classList.add('hidden');
            document.body.classList.remove('overflow-hidden');
        } else {
            sidebar.classList.add('-translate-x-full');
            sidebarOverlay.classList.add('hidden');
            document.body.classList.remove('overflow-hidden');
        }
    });    // activate the active menu item
    // function activeMenuItem() {
    //     const active_page = '{{ active_page }}';
    //     const menuItems = document.querySelectorAll('.menu-item');
    //     
    //     // Remove active class from all menu items
    //     menuItems.forEach(item => item.classList.remove('active'));
    //     
    //     // Add active class to matching item by ID
    //     if (active_page) {
    //         const activeItem = document.getElementById(active_page);
    //         if (activeItem) {
    //             activeItem.classList.add('active');
    //         }
    //     }
    // }

    // Call the function when page loads - Remove this since we're using Jinja2
    // document.addEventListener('DOMContentLoaded', activeMenuItem);

</script>